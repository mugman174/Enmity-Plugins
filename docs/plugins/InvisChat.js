function M(e){return window.enmity.assets.getIDByName(e)}window.enmity.modules.common.Constants,window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const D=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const b=window.enmity.modules.common.Toasts;window.enmity.modules.common.Dialog,window.enmity.modules.common.Token;const v=window.enmity.modules.common.REST;window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;function L(e){window.enmity.plugins.registerPlugin(e)}var N="InvisChat",R="0.0.1",E="Hide secret messages within normal messages",_=[{name:"mugman",id:"990032448115073064"}],k={name:N,version:R,description:E,authors:_};function u(e,s,n,r){window.enmity.clyde.sendReply(e,s,n,r)}var f;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(f||(f={}));var w;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(w||(w={}));var h;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(h||(h={}));var x;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(x||(x={}));var m;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"})(m||(m={}));var F;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(F||(F={}));const H={id:"invischat",name:"invis",displayName:"invis",description:"Invisible Chat",displayDescription:"Invisible Chat",type:w.Chat,inputType:h.BuiltInText,options:[{name:"text",displayName:"text",description:"Text to encode",displayDescription:"Text to encode",type:m.String,required:!0},{name:"cover",displayName:"cover",description:"message that everyone will see to cover the hidden text",displayDescription:"message that everyone will see to cover the hidden text",type:m.String,required:!0},{name:"password",displayName:"password",description:"The password to use (default: passowrd)",type:m.String,required:!1}],execute:async function(e,s){var n,r;let i=e.find(d=>d.name=="text").value,t=e.find(d=>d.name=="cover").value,c=((n=e.find(d=>d.name=="password"))==null?void 0:n.value)||"password",a=(r=(await v.post({url:"https://invis.mugman.ga",body:{type:"hide",password:c,cover:t,secret:i}})).body)==null?void 0:r.response;return a?{content:a}:(u(s.channel.id,"Failed"),{})}},G={id:"invischatdecode",name:"decode",displayName:"decode",description:"Decode Invisible Chat",displayDescription:"Decode Invisible Chat",type:w.Chat,inputType:h.BuiltInText,options:[{name:"text",displayName:"text",description:"Text to decode",displayDescription:"Text to decode",type:m.String,required:!0},{name:"password",displayName:"password",description:"The password to use (default: passowrd)",type:m.String,required:!1}],execute:async function(e,s){var n,r;let i=e.find(a=>a.name=="text").value,t=((n=e.find(a=>a.name=="password"))==null?void 0:n.value)||"password",c=(r=(await v.post({url:"https://invis.mugman.ga",body:{type:"reveal",password:t,secret:i}})).body)==null?void 0:r.response;if(!c)return u(s.channel.id,"Failed"),{};await u(s.channel.id,c)}},P=[H,G];function g(...e){return window.enmity.modules.getByProps(...e)}window.enmity.modules.common;function U(e){return window.enmity.patcher.create(e)}async function q(e,s){var n;return(n=(await v.post({url:"https://invis.mugman.ga",body:{type:"reveal",password:s||"password",secret:e}})).body)==null?void 0:n.response}const{components:o}=window.enmity;o.Alert,o.Button,o.FlatList,o.Image,o.ImageBackground,o.KeyboardAvoidingView,o.Modal,o.Pressable,o.RefreshControl,o.ScrollView,o.SectionList,o.StatusBar,o.StyleSheet,o.Switch,o.Text,o.TextInput,o.TouchableHighlight,o.TouchableOpacity,o.TouchableWithoutFeedback,o.Touchable,o.View,o.VirtualizedList,o.Form,o.FormArrow,o.FormCTA,o.FormCTAButton,o.FormCardSection,o.FormCheckbox,o.FormDivider,o.FormHint,o.FormIcon,o.FormInput,o.FormLabel,o.FormRadio;const z=o.FormRow;o.FormSection,o.FormSelect,o.FormSubLabel,o.FormSwitch,o.FormTernaryCheckBox,o.FormText,o.FormTextColors,o.FormTextSizes;const V=g("openLazy"),K=g("getLastSelectedChannelId");g("openLazy","hideActionSheet");const y=g("_currentDispatchActionType","_subscriptions","_waitQueue"),l=U("invis-chat"),Q={...k,commands:[],onStart(){this.commands=P;const e=new RegExp(/( \u200c|\u200d |[\u2060-\u2064])[^\u200b]/);y.dispatch({type:"LOAD_MESSAGES"});const s=()=>{l.before(V,"openLazy",({hideActionSheet:n},[r,i])=>{i==="MessageLongPressActionSheet"&&r.then(t=>{l.after(t,"default",(c,a,d)=>{if(d.props.children().props.children.props.children[1][0].key=="420")return;const S=d.props.children().props.children.props.children[0].props.message.content,B=K.getChannelId();!S.match(e)||d.props.children().props.children.props.children[1].unshift(D.createElement(z,{key:"420",iconSource:M("ic_locked_24px"),label:"Decode Message",onPress:()=>{q(S,void 0).then(I=>u(B,{content:I})),n()}}))})})});try{const n=y._actionHandlers._orderedActionHandlers.MESSAGE_CREATE.find(i=>i.name==="MessageStore"),r=y._actionHandlers._orderedActionHandlers.LOAD_MESSAGES_SUCCESS.find(i=>i.name==="MessageStore");l.before(n,"actionHandler",(i,t)=>{!t[0].message.content||t[0].message.content.match(e)&&(t[0].message.content+=" [:lock:]")}),l.before(r,"actionHandler",(i,t)=>{!t[0].message.content||t[0].message.content.match(e)&&(t[0].message.content+=" `[:lock:]`")}),console.log("Success"),b.open({content:"Invisible Chat has started"})}catch{b.open({content:"Invisible Chat - Trying Again"}),setTimeout(s,300)}};s()},onStop(){l.unpatchAll()}};L(Q);
